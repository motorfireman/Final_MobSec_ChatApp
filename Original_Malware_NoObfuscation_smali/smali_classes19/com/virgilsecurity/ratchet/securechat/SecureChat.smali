.class public final Lcom/virgilsecurity/ratchet/securechat/SecureChat;
.super Ljava/lang/Object;
.source "SecureChat.kt"


# annotations
.annotation system Ldalvik/annotation/MemberClasses;
    value = {
        Lcom/virgilsecurity/ratchet/securechat/SecureChat$Companion;
    }
.end annotation

.annotation runtime Lkotlin/Metadata;
    bv = {
        0x1,
        0x0,
        0x3
    }
    d1 = {
        "\u0000\u0099\u0001\n\u0002\u0018\u0002\n\u0002\u0010\u0000\n\u0000\n\u0002\u0018\u0002\n\u0002\u0008\u0002\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0002\u0008\u0014\n\u0002\u0010\u0002\n\u0000\n\u0002\u0010\u000e\n\u0002\u0008\u0003\n\u0002\u0018\u0002\n\u0000\n\u0002\u0008\u0003\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010 \n\u0002\u0008\u0004\n\u0002\u0018\u0002\n\u0002\u0008\u0004\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010\u0012\n\u0002\u0008\u0004*\u00013\u0018\u0000 L2\u00020\u0001:\u0001LB\u000f\u0008\u0016\u0012\u0006\u0010\u0002\u001a\u00020\u0003\u00a2\u0006\u0002\u0010\u0004BO\u0008\u0016\u0012\u0006\u0010\u0005\u001a\u00020\u0006\u0012\u0006\u0010\u0007\u001a\u00020\u0008\u0012\u0006\u0010\t\u001a\u00020\n\u0012\u0006\u0010\u000b\u001a\u00020\u000c\u0012\u0006\u0010\r\u001a\u00020\u000e\u0012\u0006\u0010\u000f\u001a\u00020\u0010\u0012\u0006\u0010\u0011\u001a\u00020\u0012\u0012\u0006\u0010\u0013\u001a\u00020\u0014\u0012\u0006\u0010\u0015\u001a\u00020\u0016\u00a2\u0006\u0002\u0010\u0017J\u000e\u0010*\u001a\u00020+2\u0006\u0010,\u001a\u00020-J\u001a\u0010.\u001a\u00020+2\u0006\u0010,\u001a\u00020-2\n\u0008\u0002\u0010/\u001a\u0004\u0018\u00010-J\u001c\u00100\u001a\u0004\u0018\u0001012\u0006\u0010,\u001a\u00020-2\n\u0008\u0002\u0010/\u001a\u0004\u0018\u00010-J\r\u00102\u001a\u000203H\u0002\u00a2\u0006\u0002\u00104J\u0006\u00105\u001a\u000206J\u000c\u00107\u001a\u0008\u0012\u0004\u0012\u00020908J,\u0010:\u001a\u000e\u0012\n\u0012\u0008\u0012\u0004\u0012\u0002010;082\u000c\u0010<\u001a\u0008\u0012\u0004\u0012\u00020\n0;2\n\u0008\u0002\u0010/\u001a\u0004\u0018\u00010-J\u0016\u0010=\u001a\u0002012\u0006\u0010>\u001a\u00020\n2\u0006\u0010?\u001a\u00020@J \u0010=\u001a\u0002012\u0006\u0010>\u001a\u00020\n2\u0008\u0010/\u001a\u0004\u0018\u00010-2\u0006\u0010?\u001a\u00020@J \u0010A\u001a\u0008\u0012\u0004\u0012\u000201082\u0006\u0010B\u001a\u00020\n2\n\u0008\u0002\u0010/\u001a\u0004\u0018\u00010-J4\u0010A\u001a\u0002012\u0006\u0010C\u001a\u00020-2\u0006\u0010D\u001a\u00020E2\u0008\u0010/\u001a\u0004\u0018\u00010-2\u0006\u0010F\u001a\u00020G2\u0008\u0010H\u001a\u0004\u0018\u00010IH\u0002J\u000e\u0010J\u001a\u00020+2\u0006\u0010K\u001a\u000201R\u0011\u0010\u000b\u001a\u00020\u000c\u00a2\u0006\u0008\n\u0000\u001a\u0004\u0008\u0018\u0010\u0019R\u0011\u0010\r\u001a\u00020\u000e\u00a2\u0006\u0008\n\u0000\u001a\u0004\u0008\u001a\u0010\u001bR\u0011\u0010\u0005\u001a\u00020\u0006\u00a2\u0006\u0008\n\u0000\u001a\u0004\u0008\u001c\u0010\u001dR\u0011\u0010\t\u001a\u00020\n\u00a2\u0006\u0008\n\u0000\u001a\u0004\u0008\u001e\u0010\u001fR\u0011\u0010\u0007\u001a\u00020\u0008\u00a2\u0006\u0008\n\u0000\u001a\u0004\u0008 \u0010!R\u0011\u0010\u0015\u001a\u00020\u0016\u00a2\u0006\u0008\n\u0000\u001a\u0004\u0008\"\u0010#R\u0011\u0010\u000f\u001a\u00020\u0010\u00a2\u0006\u0008\n\u0000\u001a\u0004\u0008$\u0010%R\u0011\u0010\u0011\u001a\u00020\u0012\u00a2\u0006\u0008\n\u0000\u001a\u0004\u0008&\u0010\'R\u0011\u0010\u0013\u001a\u00020\u0014\u00a2\u0006\u0008\n\u0000\u001a\u0004\u0008(\u0010)\u00a8\u0006M"
    }
    d2 = {
        "Lcom/virgilsecurity/ratchet/securechat/SecureChat;",
        "",
        "context",
        "Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;",
        "(Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;)V",
        "crypto",
        "Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;",
        "identityPrivateKey",
        "Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;",
        "identityCard",
        "Lcom/virgilsecurity/sdk/cards/Card;",
        "accessTokenProvider",
        "Lcom/virgilsecurity/sdk/jwt/contract/AccessTokenProvider;",
        "client",
        "Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;",
        "longTermKeysStorage",
        "Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;",
        "oneTimeKeysStorage",
        "Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;",
        "sessionStorage",
        "Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;",
        "keysRotator",
        "Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotatorInterface;",
        "(Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;Lcom/virgilsecurity/sdk/cards/Card;Lcom/virgilsecurity/sdk/jwt/contract/AccessTokenProvider;Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotatorInterface;)V",
        "getAccessTokenProvider",
        "()Lcom/virgilsecurity/sdk/jwt/contract/AccessTokenProvider;",
        "getClient",
        "()Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;",
        "getCrypto",
        "()Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;",
        "getIdentityCard",
        "()Lcom/virgilsecurity/sdk/cards/Card;",
        "getIdentityPrivateKey",
        "()Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;",
        "getKeysRotator",
        "()Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotatorInterface;",
        "getLongTermKeysStorage",
        "()Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;",
        "getOneTimeKeysStorage",
        "()Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;",
        "getSessionStorage",
        "()Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;",
        "deleteAllSessions",
        "",
        "participantIdentity",
        "",
        "deleteSession",
        "name",
        "existingSession",
        "Lcom/virgilsecurity/ratchet/securechat/SecureSession;",
        "replaceOneTimeKey",
        "com/virgilsecurity/ratchet/securechat/SecureChat$replaceOneTimeKey$1",
        "()Lcom/virgilsecurity/ratchet/securechat/SecureChat$replaceOneTimeKey$1;",
        "reset",
        "Lcom/virgilsecurity/common/model/Completable;",
        "rotateKeys",
        "Lcom/virgilsecurity/common/model/Result;",
        "Lcom/virgilsecurity/ratchet/securechat/keysrotation/RotationLog;",
        "startMutipleNewSessionsAsSender",
        "",
        "receiverCards",
        "startNewSessionAsReceiver",
        "senderCard",
        "ratchetMessage",
        "Lcom/virgilsecurity/crypto/ratchet/RatchetMessage;",
        "startNewSessionAsSender",
        "receiverCard",
        "identity",
        "identityPublicKey",
        "Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;",
        "longTermPublicKey",
        "Lcom/virgilsecurity/ratchet/client/data/SignedPublicKey;",
        "oneTimePublicKey",
        "",
        "storeSession",
        "session",
        "Companion",
        "ratchet"
    }
    k = 0x1
    mv = {
        0x1,
        0x1,
        0x10
    }
.end annotation


# static fields
.field public static final Companion:Lcom/virgilsecurity/ratchet/securechat/SecureChat$Companion;

.field private static final OPERATION_DEFAULT_SESSION_NAME:Ljava/lang/String; = "DEFAULT"

.field private static final OPERATION_REPLACE_ONE_TIME_KEY:Ljava/lang/String; = "replace_one_time_key"

.field private static final OPERATION_RESET:Ljava/lang/String; = "reset"

.field private static final OPERATION_ROTATE:Ljava/lang/String; = "rotate"

.field private static final OPERATION_START_MULTIPLE_NEW_SESSIONS_AS_SENDER:Ljava/lang/String; = "start_multiple_new_sessions_as_sender"

.field private static final OPERATION_START_NEW_SESSION_AS_SENDER:Ljava/lang/String; = "start_new_session_as_sender"

.field private static final SERVICE:Ljava/lang/String; = "ratchet"

.field private static final logger:Ljava/util/logging/Logger;


# instance fields
.field private final accessTokenProvider:Lcom/virgilsecurity/sdk/jwt/contract/AccessTokenProvider;

.field private final client:Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;

.field private final crypto:Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;

.field private final identityCard:Lcom/virgilsecurity/sdk/cards/Card;

.field private final identityPrivateKey:Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;

.field private final keysRotator:Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotatorInterface;

.field private final longTermKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;

.field private final oneTimeKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;

.field private final sessionStorage:Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;


# direct methods
.method static constructor <clinit>()V
    .locals 2

    new-instance v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat$Companion;

    const/4 v1, 0x0

    invoke-direct {v0, v1}, Lcom/virgilsecurity/ratchet/securechat/SecureChat$Companion;-><init>(Lkotlin/jvm/internal/DefaultConstructorMarker;)V

    sput-object v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->Companion:Lcom/virgilsecurity/ratchet/securechat/SecureChat$Companion;

    .line 513
    const-class v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;

    invoke-virtual {v0}, Ljava/lang/Class;->getName()Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/util/logging/Logger;->getLogger(Ljava/lang/String;)Ljava/util/logging/Logger;

    move-result-object v0

    sput-object v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->logger:Ljava/util/logging/Logger;

    return-void
.end method

.method public constructor <init>(Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;)V
    .locals 12
    .param p1, "context"    # Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;

    const-string v0, "context"

    invoke-static {p1, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 76
    invoke-direct {p0}, Ljava/lang/Object;-><init>()V

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getVirgilCrypto()Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;

    move-result-object v2

    iput-object v2, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->crypto:Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;

    .line 77
    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getRatchetClient()Lcom/virgilsecurity/ratchet/client/RatchetClient;

    move-result-object v0

    move-object v11, v0

    check-cast v11, Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;

    iput-object v11, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->client:Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;

    .line 78
    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getAccessTokenProvider()Lcom/virgilsecurity/sdk/jwt/contract/AccessTokenProvider;

    move-result-object v0

    iput-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->accessTokenProvider:Lcom/virgilsecurity/sdk/jwt/contract/AccessTokenProvider;

    .line 79
    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getIdentityKeyPair()Lcom/virgilsecurity/sdk/crypto/VirgilKeyPair;

    move-result-object v0

    invoke-virtual {v0}, Lcom/virgilsecurity/sdk/crypto/VirgilKeyPair;->getPrivateKey()Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;

    move-result-object v0

    const-string v1, "context.identityKeyPair.privateKey"

    invoke-static {v0, v1}, Lkotlin/jvm/internal/Intrinsics;->checkExpressionValueIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    iput-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->identityPrivateKey:Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;

    .line 80
    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getIdentityCard()Lcom/virgilsecurity/sdk/cards/Card;

    move-result-object v0

    iput-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->identityCard:Lcom/virgilsecurity/sdk/cards/Card;

    .line 82
    nop

    .line 83
    new-instance v0, Lcom/virgilsecurity/ratchet/keystorage/FileLongTermKeysStorage;

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getIdentityCard()Lcom/virgilsecurity/sdk/cards/Card;

    move-result-object v3

    invoke-virtual {v3}, Lcom/virgilsecurity/sdk/cards/Card;->getIdentity()Ljava/lang/String;

    move-result-object v3

    const-string v4, "context.identityCard.identity"

    invoke-static {v3, v4}, Lkotlin/jvm/internal/Intrinsics;->checkExpressionValueIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getIdentityKeyPair()Lcom/virgilsecurity/sdk/crypto/VirgilKeyPair;

    move-result-object v5

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getRootPath()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v0, v3, v2, v5, v6}, Lcom/virgilsecurity/ratchet/keystorage/FileLongTermKeysStorage;-><init>(Ljava/lang/String;Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;Lcom/virgilsecurity/sdk/crypto/VirgilKeyPair;Ljava/lang/String;)V

    move-object v9, v0

    check-cast v9, Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;

    iput-object v9, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->longTermKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;

    .line 84
    nop

    .line 85
    new-instance v0, Lcom/virgilsecurity/ratchet/keystorage/FileOneTimeKeysStorage;

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getIdentityCard()Lcom/virgilsecurity/sdk/cards/Card;

    move-result-object v3

    invoke-virtual {v3}, Lcom/virgilsecurity/sdk/cards/Card;->getIdentity()Ljava/lang/String;

    move-result-object v3

    invoke-static {v3, v4}, Lkotlin/jvm/internal/Intrinsics;->checkExpressionValueIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getIdentityKeyPair()Lcom/virgilsecurity/sdk/crypto/VirgilKeyPair;

    move-result-object v5

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getRootPath()Ljava/lang/String;

    move-result-object v6

    invoke-direct {v0, v3, v2, v5, v6}, Lcom/virgilsecurity/ratchet/keystorage/FileOneTimeKeysStorage;-><init>(Ljava/lang/String;Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;Lcom/virgilsecurity/sdk/crypto/VirgilKeyPair;Ljava/lang/String;)V

    move-object v10, v0

    check-cast v10, Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;

    iput-object v10, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->oneTimeKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;

    .line 86
    nop

    .line 87
    new-instance v0, Lcom/virgilsecurity/ratchet/sessionstorage/FileSessionStorage;

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getIdentityCard()Lcom/virgilsecurity/sdk/cards/Card;

    move-result-object v3

    invoke-virtual {v3}, Lcom/virgilsecurity/sdk/cards/Card;->getIdentity()Ljava/lang/String;

    move-result-object v3

    invoke-static {v3, v4}, Lkotlin/jvm/internal/Intrinsics;->checkExpressionValueIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getIdentityKeyPair()Lcom/virgilsecurity/sdk/crypto/VirgilKeyPair;

    move-result-object v4

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getRootPath()Ljava/lang/String;

    move-result-object v5

    invoke-direct {v0, v3, v2, v4, v5}, Lcom/virgilsecurity/ratchet/sessionstorage/FileSessionStorage;-><init>(Ljava/lang/String;Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;Lcom/virgilsecurity/sdk/crypto/VirgilKeyPair;Ljava/lang/String;)V

    check-cast v0, Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;

    iput-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->sessionStorage:Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;

    .line 88
    new-instance v0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;

    .line 89
    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getIdentityKeyPair()Lcom/virgilsecurity/sdk/crypto/VirgilKeyPair;

    move-result-object v3

    invoke-virtual {v3}, Lcom/virgilsecurity/sdk/crypto/VirgilKeyPair;->getPrivateKey()Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;

    move-result-object v3

    invoke-static {v3, v1}, Lkotlin/jvm/internal/Intrinsics;->checkExpressionValueIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getIdentityCard()Lcom/virgilsecurity/sdk/cards/Card;

    move-result-object v1

    invoke-virtual {v1}, Lcom/virgilsecurity/sdk/cards/Card;->getIdentifier()Ljava/lang/String;

    move-result-object v4

    const-string v1, "context.identityCard.identifier"

    invoke-static {v4, v1}, Lkotlin/jvm/internal/Intrinsics;->checkExpressionValueIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 90
    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getOrphanedOneTimeKeyTtl()I

    move-result v5

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getLongTermKeyTtl()I

    move-result v6

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getOutdatedLongTermKeyTtl()I

    move-result v7

    .line 91
    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureChatContext;->getDesiredNumberOfOneTimeKeys()I

    move-result v8

    .line 92
    nop

    .line 88
    move-object v1, v0

    invoke-direct/range {v1 .. v11}, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;-><init>(Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;Ljava/lang/String;IIIILcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;)V

    check-cast v0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotatorInterface;

    iput-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->keysRotator:Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotatorInterface;

    return-void
.end method

.method public constructor <init>(Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;Lcom/virgilsecurity/sdk/cards/Card;Lcom/virgilsecurity/sdk/jwt/contract/AccessTokenProvider;Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotatorInterface;)V
    .locals 1
    .param p1, "crypto"    # Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;
    .param p2, "identityPrivateKey"    # Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;
    .param p3, "identityCard"    # Lcom/virgilsecurity/sdk/cards/Card;
    .param p4, "accessTokenProvider"    # Lcom/virgilsecurity/sdk/jwt/contract/AccessTokenProvider;
    .param p5, "client"    # Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;
    .param p6, "longTermKeysStorage"    # Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;
    .param p7, "oneTimeKeysStorage"    # Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;
    .param p8, "sessionStorage"    # Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;
    .param p9, "keysRotator"    # Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotatorInterface;

    const-string v0, "crypto"

    invoke-static {p1, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "identityPrivateKey"

    invoke-static {p2, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "identityCard"

    invoke-static {p3, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "accessTokenProvider"

    invoke-static {p4, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "client"

    invoke-static {p5, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "longTermKeysStorage"

    invoke-static {p6, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "oneTimeKeysStorage"

    invoke-static {p7, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "sessionStorage"

    invoke-static {p8, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "keysRotator"

    invoke-static {p9, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 121
    invoke-direct {p0}, Ljava/lang/Object;-><init>()V

    iput-object p1, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->crypto:Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;

    .line 122
    iput-object p2, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->identityPrivateKey:Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;

    .line 123
    iput-object p3, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->identityCard:Lcom/virgilsecurity/sdk/cards/Card;

    .line 124
    iput-object p4, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->accessTokenProvider:Lcom/virgilsecurity/sdk/jwt/contract/AccessTokenProvider;

    .line 125
    iput-object p5, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->client:Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;

    .line 126
    iput-object p6, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->longTermKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;

    .line 127
    iput-object p7, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->oneTimeKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;

    .line 128
    iput-object p8, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->sessionStorage:Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;

    .line 129
    iput-object p9, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->keysRotator:Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotatorInterface;

    return-void
.end method

.method public static final synthetic access$getLogger$cp()Ljava/util/logging/Logger;
    .locals 1

    .line 58
    sget-object v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->logger:Ljava/util/logging/Logger;

    return-object v0
.end method

.method public static final synthetic access$startNewSessionAsSender(Lcom/virgilsecurity/ratchet/securechat/SecureChat;Ljava/lang/String;Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;Ljava/lang/String;Lcom/virgilsecurity/ratchet/client/data/SignedPublicKey;[B)Lcom/virgilsecurity/ratchet/securechat/SecureSession;
    .locals 1
    .param p0, "$this"    # Lcom/virgilsecurity/ratchet/securechat/SecureChat;
    .param p1, "identity"    # Ljava/lang/String;
    .param p2, "identityPublicKey"    # Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;
    .param p3, "name"    # Ljava/lang/String;
    .param p4, "longTermPublicKey"    # Lcom/virgilsecurity/ratchet/client/data/SignedPublicKey;
    .param p5, "oneTimePublicKey"    # [B

    .line 58
    invoke-direct/range {p0 .. p5}, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->startNewSessionAsSender(Ljava/lang/String;Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;Ljava/lang/String;Lcom/virgilsecurity/ratchet/client/data/SignedPublicKey;[B)Lcom/virgilsecurity/ratchet/securechat/SecureSession;

    move-result-object v0

    return-object v0
.end method

.method public static synthetic deleteSession$default(Lcom/virgilsecurity/ratchet/securechat/SecureChat;Ljava/lang/String;Ljava/lang/String;ILjava/lang/Object;)V
    .locals 0

    and-int/lit8 p3, p3, 0x2

    if-eqz p3, :cond_0

    .line 198
    const/4 p2, 0x0

    move-object p3, p2

    check-cast p3, Ljava/lang/String;

    :cond_0
    invoke-virtual {p0, p1, p2}, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->deleteSession(Ljava/lang/String;Ljava/lang/String;)V

    return-void
.end method

.method public static synthetic existingSession$default(Lcom/virgilsecurity/ratchet/securechat/SecureChat;Ljava/lang/String;Ljava/lang/String;ILjava/lang/Object;)Lcom/virgilsecurity/ratchet/securechat/SecureSession;
    .locals 0

    and-int/lit8 p3, p3, 0x2

    if-eqz p3, :cond_0

    .line 181
    const/4 p2, 0x0

    move-object p3, p2

    check-cast p3, Ljava/lang/String;

    :cond_0
    invoke-virtual {p0, p1, p2}, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->existingSession(Ljava/lang/String;Ljava/lang/String;)Lcom/virgilsecurity/ratchet/securechat/SecureSession;

    move-result-object p0

    return-object p0
.end method

.method private final replaceOneTimeKey()Lcom/virgilsecurity/ratchet/securechat/SecureChat$replaceOneTimeKey$1;
    .locals 1

    .line 338
    new-instance v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat$replaceOneTimeKey$1;

    invoke-direct {v0, p0}, Lcom/virgilsecurity/ratchet/securechat/SecureChat$replaceOneTimeKey$1;-><init>(Lcom/virgilsecurity/ratchet/securechat/SecureChat;)V

    .line 377
    return-object v0
.end method

.method public static synthetic startMutipleNewSessionsAsSender$default(Lcom/virgilsecurity/ratchet/securechat/SecureChat;Ljava/util/List;Ljava/lang/String;ILjava/lang/Object;)Lcom/virgilsecurity/common/model/Result;
    .locals 0

    and-int/lit8 p3, p3, 0x2

    if-eqz p3, :cond_0

    .line 262
    const/4 p2, 0x0

    move-object p3, p2

    check-cast p3, Ljava/lang/String;

    :cond_0
    invoke-virtual {p0, p1, p2}, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->startMutipleNewSessionsAsSender(Ljava/util/List;Ljava/lang/String;)Lcom/virgilsecurity/common/model/Result;

    move-result-object p0

    return-object p0
.end method

.method private final startNewSessionAsSender(Ljava/lang/String;Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;Ljava/lang/String;Lcom/virgilsecurity/ratchet/client/data/SignedPublicKey;[B)Lcom/virgilsecurity/ratchet/securechat/SecureSession;
    .locals 10
    .param p1, "identity"    # Ljava/lang/String;
    .param p2, "identityPublicKey"    # Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;
    .param p3, "name"    # Ljava/lang/String;
    .param p4, "longTermPublicKey"    # Lcom/virgilsecurity/ratchet/client/data/SignedPublicKey;
    .param p5, "oneTimePublicKey"    # [B

    .line 326
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->crypto:Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;

    invoke-virtual {p4}, Lcom/virgilsecurity/ratchet/client/data/SignedPublicKey;->getSignature()[B

    move-result-object v1

    invoke-virtual {p4}, Lcom/virgilsecurity/ratchet/client/data/SignedPublicKey;->getPublicKey()[B

    move-result-object v2

    invoke-virtual {v0, v1, v2, p2}, Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;->verifySignature([B[BLcom/virgilsecurity/sdk/crypto/VirgilPublicKey;)Z

    move-result v0

    if-eqz v0, :cond_2

    .line 329
    if-nez p5, :cond_0

    .line 330
    sget-object v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->logger:Ljava/util/logging/Logger;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Creating weak session with "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/util/logging/Logger;->warning(Ljava/lang/String;)V

    .line 332
    :cond_0
    new-instance v0, Lcom/virgilsecurity/ratchet/securechat/SecureSession;

    .line 333
    iget-object v3, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->crypto:Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;

    if-eqz p3, :cond_1

    move-object v5, p3

    goto :goto_0

    :cond_1
    const-string v1, "DEFAULT"

    move-object v5, v1

    .line 334
    :goto_0
    iget-object v6, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->identityPrivateKey:Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;

    invoke-virtual {p4}, Lcom/virgilsecurity/ratchet/client/data/SignedPublicKey;->getPublicKey()[B

    move-result-object v8

    .line 332
    move-object v2, v0

    move-object v4, p1

    move-object v7, p2

    move-object v9, p5

    invoke-direct/range {v2 .. v9}, Lcom/virgilsecurity/ratchet/securechat/SecureSession;-><init>(Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;Ljava/lang/String;Ljava/lang/String;Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;[B[B)V

    return-object v0

    .line 327
    :cond_2
    new-instance v0, Lcom/virgilsecurity/ratchet/exception/SecureChatException;

    const/4 v1, 0x4

    const/4 v2, 0x2

    const/4 v3, 0x0

    invoke-direct {v0, v1, v3, v2, v3}, Lcom/virgilsecurity/ratchet/exception/SecureChatException;-><init>(ILjava/lang/String;ILkotlin/jvm/internal/DefaultConstructorMarker;)V

    check-cast v0, Ljava/lang/Throwable;

    throw v0
.end method

.method public static synthetic startNewSessionAsSender$default(Lcom/virgilsecurity/ratchet/securechat/SecureChat;Lcom/virgilsecurity/sdk/cards/Card;Ljava/lang/String;ILjava/lang/Object;)Lcom/virgilsecurity/common/model/Result;
    .locals 0

    and-int/lit8 p3, p3, 0x2

    if-eqz p3, :cond_0

    .line 223
    const/4 p2, 0x0

    move-object p3, p2

    check-cast p3, Ljava/lang/String;

    :cond_0
    invoke-virtual {p0, p1, p2}, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->startNewSessionAsSender(Lcom/virgilsecurity/sdk/cards/Card;Ljava/lang/String;)Lcom/virgilsecurity/common/model/Result;

    move-result-object p0

    return-object p0
.end method


# virtual methods
.method public final deleteAllSessions(Ljava/lang/String;)V
    .locals 3
    .param p1, "participantIdentity"    # Ljava/lang/String;

    const-string v0, "participantIdentity"

    invoke-static {p1, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 210
    sget-object v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->logger:Ljava/util/logging/Logger;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Deleting session with "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/util/logging/Logger;->fine(Ljava/lang/String;)V

    .line 212
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->sessionStorage:Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;

    const/4 v1, 0x0

    invoke-interface {v0, p1, v1}, Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;->deleteSession(Ljava/lang/String;Ljava/lang/String;)V

    .line 213
    return-void
.end method

.method public final deleteSession(Ljava/lang/String;Ljava/lang/String;)V
    .locals 3
    .param p1, "participantIdentity"    # Ljava/lang/String;
    .param p2, "name"    # Ljava/lang/String;

    const-string v0, "participantIdentity"

    invoke-static {p1, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 199
    sget-object v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->logger:Ljava/util/logging/Logger;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Deleting session with "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/util/logging/Logger;->fine(Ljava/lang/String;)V

    .line 201
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->sessionStorage:Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;

    if-eqz p2, :cond_0

    move-object v1, p2

    goto :goto_0

    :cond_0
    const-string v1, "DEFAULT"

    :goto_0
    invoke-interface {v0, p1, v1}, Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;->deleteSession(Ljava/lang/String;Ljava/lang/String;)V

    .line 202
    return-void
.end method

.method public final existingSession(Ljava/lang/String;Ljava/lang/String;)Lcom/virgilsecurity/ratchet/securechat/SecureSession;
    .locals 4
    .param p1, "participantIdentity"    # Ljava/lang/String;
    .param p2, "name"    # Ljava/lang/String;

    const-string v0, "participantIdentity"

    invoke-static {p1, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 182
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->sessionStorage:Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;

    if-eqz p2, :cond_0

    move-object v1, p2

    goto :goto_0

    :cond_0
    const-string v1, "DEFAULT"

    :goto_0
    invoke-interface {v0, p1, v1}, Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;->retrieveSession(Ljava/lang/String;Ljava/lang/String;)Lcom/virgilsecurity/ratchet/securechat/SecureSession;

    move-result-object v0

    .line 183
    .local v0, "session":Lcom/virgilsecurity/ratchet/securechat/SecureSession;
    if-eqz v0, :cond_1

    .line 184
    sget-object v1, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->logger:Ljava/util/logging/Logger;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Found existing session with "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/util/logging/Logger;->fine(Ljava/lang/String;)V

    .line 185
    move-object v1, v0

    goto :goto_1

    .line 187
    :cond_1
    sget-object v1, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->logger:Ljava/util/logging/Logger;

    new-instance v2, Ljava/lang/StringBuilder;

    invoke-direct {v2}, Ljava/lang/StringBuilder;-><init>()V

    const-string v3, "Existing session with "

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2, p1}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    const-string v3, " was not found"

    invoke-virtual {v2, v3}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v2

    invoke-virtual {v2}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/util/logging/Logger;->fine(Ljava/lang/String;)V

    .line 188
    const/4 v1, 0x0

    .line 183
    :goto_1
    return-object v1
.end method

.method public final getAccessTokenProvider()Lcom/virgilsecurity/sdk/jwt/contract/AccessTokenProvider;
    .locals 1

    .line 60
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->accessTokenProvider:Lcom/virgilsecurity/sdk/jwt/contract/AccessTokenProvider;

    return-object v0
.end method

.method public final getClient()Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;
    .locals 1

    .line 66
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->client:Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;

    return-object v0
.end method

.method public final getCrypto()Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;
    .locals 1

    .line 62
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->crypto:Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;

    return-object v0
.end method

.method public final getIdentityCard()Lcom/virgilsecurity/sdk/cards/Card;
    .locals 1

    .line 67
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->identityCard:Lcom/virgilsecurity/sdk/cards/Card;

    return-object v0
.end method

.method public final getIdentityPrivateKey()Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;
    .locals 1

    .line 61
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->identityPrivateKey:Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;

    return-object v0
.end method

.method public final getKeysRotator()Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotatorInterface;
    .locals 1

    .line 68
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->keysRotator:Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotatorInterface;

    return-object v0
.end method

.method public final getLongTermKeysStorage()Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;
    .locals 1

    .line 63
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->longTermKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;

    return-object v0
.end method

.method public final getOneTimeKeysStorage()Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;
    .locals 1

    .line 64
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->oneTimeKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;

    return-object v0
.end method

.method public final getSessionStorage()Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;
    .locals 1

    .line 65
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->sessionStorage:Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;

    return-object v0
.end method

.method public final reset()Lcom/virgilsecurity/common/model/Completable;
    .locals 1

    .line 476
    new-instance v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat$reset$1;

    invoke-direct {v0, p0}, Lcom/virgilsecurity/ratchet/securechat/SecureChat$reset$1;-><init>(Lcom/virgilsecurity/ratchet/securechat/SecureChat;)V

    check-cast v0, Lcom/virgilsecurity/common/model/Completable;

    .line 497
    return-object v0
.end method

.method public final rotateKeys()Lcom/virgilsecurity/common/model/Result;
    .locals 1
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "()",
            "Lcom/virgilsecurity/common/model/Result<",
            "Lcom/virgilsecurity/ratchet/securechat/keysrotation/RotationLog;",
            ">;"
        }
    .end annotation

    .line 148
    new-instance v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat$rotateKeys$1;

    invoke-direct {v0, p0}, Lcom/virgilsecurity/ratchet/securechat/SecureChat$rotateKeys$1;-><init>(Lcom/virgilsecurity/ratchet/securechat/SecureChat;)V

    check-cast v0, Lcom/virgilsecurity/common/model/Result;

    .line 157
    return-object v0
.end method

.method public final startMutipleNewSessionsAsSender(Ljava/util/List;Ljava/lang/String;)Lcom/virgilsecurity/common/model/Result;
    .locals 1
    .param p1, "receiverCards"    # Ljava/util/List;
    .param p2, "name"    # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Ljava/util/List<",
            "+",
            "Lcom/virgilsecurity/sdk/cards/Card;",
            ">;",
            "Ljava/lang/String;",
            ")",
            "Lcom/virgilsecurity/common/model/Result<",
            "Ljava/util/List<",
            "Lcom/virgilsecurity/ratchet/securechat/SecureSession;",
            ">;>;"
        }
    .end annotation

    const-string v0, "receiverCards"

    invoke-static {p1, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 262
    new-instance v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat$startMutipleNewSessionsAsSender$1;

    invoke-direct {v0, p0, p1, p2}, Lcom/virgilsecurity/ratchet/securechat/SecureChat$startMutipleNewSessionsAsSender$1;-><init>(Lcom/virgilsecurity/ratchet/securechat/SecureChat;Ljava/util/List;Ljava/lang/String;)V

    check-cast v0, Lcom/virgilsecurity/common/model/Result;

    .line 320
    return-object v0
.end method

.method public final startNewSessionAsReceiver(Lcom/virgilsecurity/sdk/cards/Card;Lcom/virgilsecurity/crypto/ratchet/RatchetMessage;)Lcom/virgilsecurity/ratchet/securechat/SecureSession;
    .locals 1
    .param p1, "senderCard"    # Lcom/virgilsecurity/sdk/cards/Card;
    .param p2, "ratchetMessage"    # Lcom/virgilsecurity/crypto/ratchet/RatchetMessage;

    const-string v0, "senderCard"

    invoke-static {p1, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "ratchetMessage"

    invoke-static {p2, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 390
    const/4 v0, 0x0

    invoke-virtual {p0, p1, v0, p2}, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->startNewSessionAsReceiver(Lcom/virgilsecurity/sdk/cards/Card;Ljava/lang/String;Lcom/virgilsecurity/crypto/ratchet/RatchetMessage;)Lcom/virgilsecurity/ratchet/securechat/SecureSession;

    move-result-object v0

    return-object v0
.end method

.method public final startNewSessionAsReceiver(Lcom/virgilsecurity/sdk/cards/Card;Ljava/lang/String;Lcom/virgilsecurity/crypto/ratchet/RatchetMessage;)Lcom/virgilsecurity/ratchet/securechat/SecureSession;
    .locals 18
    .param p1, "senderCard"    # Lcom/virgilsecurity/sdk/cards/Card;
    .param p2, "name"    # Ljava/lang/String;
    .param p3, "ratchetMessage"    # Lcom/virgilsecurity/crypto/ratchet/RatchetMessage;

    move-object/from16 v1, p0

    move-object/from16 v2, p2

    const-string v0, "senderCard"

    move-object/from16 v3, p1

    invoke-static {v3, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "ratchetMessage"

    move-object/from16 v13, p3

    invoke-static {v13, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 405
    sget-object v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->logger:Ljava/util/logging/Logger;

    new-instance v4, Ljava/lang/StringBuilder;

    invoke-direct {v4}, Ljava/lang/StringBuilder;-><init>()V

    const-string v5, "Responding to session with "

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual/range {p1 .. p1}, Lcom/virgilsecurity/sdk/cards/Card;->getIdentity()Ljava/lang/String;

    move-result-object v5

    invoke-virtual {v4, v5}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v4

    invoke-virtual {v4}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v4

    invoke-virtual {v0, v4}, Ljava/util/logging/Logger;->fine(Ljava/lang/String;)V

    .line 407
    invoke-virtual/range {p1 .. p1}, Lcom/virgilsecurity/sdk/cards/Card;->getIdentity()Ljava/lang/String;

    move-result-object v0

    const-string v4, "senderCard.identity"

    invoke-static {v0, v4}, Lkotlin/jvm/internal/Intrinsics;->checkExpressionValueIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    invoke-virtual {v1, v0, v2}, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->existingSession(Ljava/lang/String;Ljava/lang/String;)Lcom/virgilsecurity/ratchet/securechat/SecureSession;

    move-result-object v0

    if-nez v0, :cond_9

    .line 414
    invoke-virtual/range {p1 .. p1}, Lcom/virgilsecurity/sdk/cards/Card;->getPublicKey()Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;

    move-result-object v0

    instance-of v0, v0, Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;

    if-eqz v0, :cond_8

    .line 420
    invoke-virtual/range {p1 .. p1}, Lcom/virgilsecurity/sdk/cards/Card;->getPublicKey()Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;

    move-result-object v8

    if-eqz v8, :cond_7

    .line 422
    .local v8, "senderIdentityPublicKey":Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;
    invoke-virtual {v8}, Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;->getKeyPairType()Lcom/virgilsecurity/sdk/crypto/KeyPairType;

    move-result-object v0

    sget-object v5, Lcom/virgilsecurity/sdk/crypto/KeyPairType;->ED25519:Lcom/virgilsecurity/sdk/crypto/KeyPairType;

    if-ne v0, v5, :cond_6

    .line 429
    invoke-virtual/range {p3 .. p3}, Lcom/virgilsecurity/crypto/ratchet/RatchetMessage;->getType()Lcom/virgilsecurity/crypto/ratchet/MsgType;

    move-result-object v0

    sget-object v5, Lcom/virgilsecurity/crypto/ratchet/MsgType;->PREKEY:Lcom/virgilsecurity/crypto/ratchet/MsgType;

    if-ne v0, v5, :cond_5

    .line 436
    invoke-virtual/range {p3 .. p3}, Lcom/virgilsecurity/crypto/ratchet/RatchetMessage;->getReceiverLongTermKeyId()[B

    move-result-object v14

    .line 437
    .local v14, "longTermKeyId":[B
    iget-object v0, v1, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->longTermKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;

    const-string v5, "longTermKeyId"

    invoke-static {v14, v5}, Lkotlin/jvm/internal/Intrinsics;->checkExpressionValueIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    invoke-interface {v0, v14}, Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;->retrieveKey([B)Lcom/virgilsecurity/ratchet/keystorage/LongTermKey;

    move-result-object v15

    .line 438
    .local v15, "receiverLongTermPrivateKey":Lcom/virgilsecurity/ratchet/keystorage/LongTermKey;
    invoke-virtual/range {p3 .. p3}, Lcom/virgilsecurity/crypto/ratchet/RatchetMessage;->getReceiverOneTimeKeyId()[B

    move-result-object v12

    .line 439
    .local v12, "receiverOneTimeKeyId":[B
    const/4 v5, 0x0

    .line 440
    .local v5, "receiverOneTimePrivateKey":Lcom/virgilsecurity/ratchet/keystorage/OneTimeKey;
    const/4 v6, 0x0

    .line 441
    .local v6, "interactionStarted":Z
    nop

    .line 442
    if-nez v12, :cond_0

    .line 443
    const/4 v0, 0x0

    :try_start_0
    move-object v7, v0

    check-cast v7, Lcom/virgilsecurity/ratchet/keystorage/OneTimeKey;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    move-object/from16 v16, v0

    move/from16 v17, v6

    .end local v5    # "receiverOneTimePrivateKey":Lcom/virgilsecurity/ratchet/keystorage/OneTimeKey;
    .local v0, "receiverOneTimePrivateKey":Lcom/virgilsecurity/ratchet/keystorage/OneTimeKey;
    goto :goto_0

    .line 470
    .end local v0    # "receiverOneTimePrivateKey":Lcom/virgilsecurity/ratchet/keystorage/OneTimeKey;
    .restart local v5    # "receiverOneTimePrivateKey":Lcom/virgilsecurity/ratchet/keystorage/OneTimeKey;
    :catchall_0
    move-exception v0

    move-object v2, v12

    goto :goto_2

    .line 445
    :cond_0
    :try_start_1
    iget-object v0, v1, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->oneTimeKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;

    invoke-interface {v0}, Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;->startInteraction()V

    .line 446
    const/4 v6, 0x1

    .line 447
    iget-object v0, v1, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->oneTimeKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;

    invoke-interface {v0, v12}, Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;->retrieveKey([B)Lcom/virgilsecurity/ratchet/keystorage/OneTimeKey;

    move-result-object v0
    :try_end_1
    .catchall {:try_start_1 .. :try_end_1} :catchall_3

    move-object/from16 v16, v0

    move/from16 v17, v6

    .line 448
    .end local v5    # "receiverOneTimePrivateKey":Lcom/virgilsecurity/ratchet/keystorage/OneTimeKey;
    .end local v6    # "interactionStarted":Z
    .local v16, "receiverOneTimePrivateKey":Lcom/virgilsecurity/ratchet/keystorage/OneTimeKey;
    .local v17, "interactionStarted":Z
    :goto_0
    nop

    .line 450
    :try_start_2
    new-instance v0, Lcom/virgilsecurity/ratchet/securechat/SecureSession;

    .line 451
    iget-object v5, v1, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->crypto:Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;

    .line 452
    invoke-virtual/range {p1 .. p1}, Lcom/virgilsecurity/sdk/cards/Card;->getIdentity()Ljava/lang/String;

    move-result-object v6

    invoke-static {v6, v4}, Lkotlin/jvm/internal/Intrinsics;->checkExpressionValueIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 453
    if-eqz v2, :cond_1

    move-object v7, v2

    goto :goto_1

    :cond_1
    const-string v4, "DEFAULT"

    move-object v7, v4

    .line 454
    :goto_1
    nop

    .line 455
    iget-object v9, v1, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->identityPrivateKey:Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;
    :try_end_2
    .catchall {:try_start_2 .. :try_end_2} :catchall_2

    .line 456
    nop

    .line 457
    nop

    .line 458
    nop

    .line 450
    move-object v4, v0

    move-object v10, v15

    move-object/from16 v11, v16

    move-object v2, v12

    .end local v12    # "receiverOneTimeKeyId":[B
    .local v2, "receiverOneTimeKeyId":[B
    move-object/from16 v12, p3

    :try_start_3
    invoke-direct/range {v4 .. v12}, Lcom/virgilsecurity/ratchet/securechat/SecureSession;-><init>(Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;Ljava/lang/String;Ljava/lang/String;Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;Lcom/virgilsecurity/ratchet/keystorage/LongTermKey;Lcom/virgilsecurity/ratchet/keystorage/OneTimeKey;Lcom/virgilsecurity/crypto/ratchet/RatchetMessage;)V

    .line 461
    .local v0, "session":Lcom/virgilsecurity/ratchet/securechat/SecureSession;
    if-eqz v2, :cond_2

    .line 462
    iget-object v4, v1, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->oneTimeKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;

    invoke-interface {v4, v2}, Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;->deleteKey([B)V

    .line 463
    invoke-direct/range {p0 .. p0}, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->replaceOneTimeKey()Lcom/virgilsecurity/ratchet/securechat/SecureChat$replaceOneTimeKey$1;

    move-result-object v4

    invoke-virtual {v4}, Lcom/virgilsecurity/ratchet/securechat/SecureChat$replaceOneTimeKey$1;->execute()V
    :try_end_3
    .catchall {:try_start_3 .. :try_end_3} :catchall_1

    .line 465
    :cond_2
    nop

    .line 467
    if-eqz v17, :cond_3

    .line 468
    iget-object v4, v1, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->oneTimeKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;

    invoke-interface {v4}, Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;->stopInteraction()V

    :cond_3
    return-object v0

    .line 470
    .end local v0    # "session":Lcom/virgilsecurity/ratchet/securechat/SecureSession;
    :catchall_1
    move-exception v0

    move-object/from16 v5, v16

    move/from16 v6, v17

    goto :goto_2

    .end local v2    # "receiverOneTimeKeyId":[B
    .restart local v12    # "receiverOneTimeKeyId":[B
    :catchall_2
    move-exception v0

    move-object v2, v12

    move-object/from16 v5, v16

    move/from16 v6, v17

    .end local v12    # "receiverOneTimeKeyId":[B
    .restart local v2    # "receiverOneTimeKeyId":[B
    goto :goto_2

    .end local v2    # "receiverOneTimeKeyId":[B
    .end local v16    # "receiverOneTimePrivateKey":Lcom/virgilsecurity/ratchet/keystorage/OneTimeKey;
    .end local v17    # "interactionStarted":Z
    .restart local v5    # "receiverOneTimePrivateKey":Lcom/virgilsecurity/ratchet/keystorage/OneTimeKey;
    .restart local v6    # "interactionStarted":Z
    .restart local v12    # "receiverOneTimeKeyId":[B
    :catchall_3
    move-exception v0

    move-object v2, v12

    .line 467
    .end local v12    # "receiverOneTimeKeyId":[B
    .restart local v2    # "receiverOneTimeKeyId":[B
    :goto_2
    if-eqz v6, :cond_4

    .line 468
    iget-object v4, v1, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->oneTimeKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;

    invoke-interface {v4}, Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;->stopInteraction()V

    :cond_4
    throw v0

    .line 430
    .end local v2    # "receiverOneTimeKeyId":[B
    .end local v5    # "receiverOneTimePrivateKey":Lcom/virgilsecurity/ratchet/keystorage/OneTimeKey;
    .end local v6    # "interactionStarted":Z
    .end local v14    # "longTermKeyId":[B
    .end local v15    # "receiverLongTermPrivateKey":Lcom/virgilsecurity/ratchet/keystorage/LongTermKey;
    :cond_5
    new-instance v0, Lcom/virgilsecurity/ratchet/exception/SecureChatException;

    .line 431
    const/4 v2, 0x5

    .line 432
    nop

    .line 430
    const-string v4, "Ratchet message should be PREKEY type"

    invoke-direct {v0, v2, v4}, Lcom/virgilsecurity/ratchet/exception/SecureChatException;-><init>(ILjava/lang/String;)V

    check-cast v0, Ljava/lang/Throwable;

    throw v0

    .line 423
    :cond_6
    new-instance v0, Lcom/virgilsecurity/ratchet/exception/SecureChatException;

    .line 424
    const/4 v2, 0x6

    .line 425
    nop

    .line 423
    const-string v4, "Identity public key should be a ED25519 type"

    invoke-direct {v0, v2, v4}, Lcom/virgilsecurity/ratchet/exception/SecureChatException;-><init>(ILjava/lang/String;)V

    check-cast v0, Ljava/lang/Throwable;

    throw v0

    .line 420
    .end local v8    # "senderIdentityPublicKey":Lcom/virgilsecurity/sdk/crypto/VirgilPublicKey;
    :cond_7
    new-instance v0, Lkotlin/TypeCastException;

    const-string v2, "null cannot be cast to non-null type com.virgilsecurity.sdk.crypto.VirgilPublicKey"

    invoke-direct {v0, v2}, Lkotlin/TypeCastException;-><init>(Ljava/lang/String;)V

    throw v0

    .line 415
    :cond_8
    new-instance v0, Lcom/virgilsecurity/ratchet/exception/SecureChatException;

    .line 416
    const/4 v2, 0x2

    .line 417
    nop

    .line 415
    const-string v4, "Identity public key should be a VirgilPublicKey"

    invoke-direct {v0, v2, v4}, Lcom/virgilsecurity/ratchet/exception/SecureChatException;-><init>(ILjava/lang/String;)V

    check-cast v0, Ljava/lang/Throwable;

    throw v0

    .line 408
    :cond_9
    new-instance v0, Lcom/virgilsecurity/ratchet/exception/SecureChatException;

    .line 409
    const/4 v2, 0x1

    .line 410
    nop

    .line 408
    const-string v4, "Session already exists"

    invoke-direct {v0, v2, v4}, Lcom/virgilsecurity/ratchet/exception/SecureChatException;-><init>(ILjava/lang/String;)V

    check-cast v0, Ljava/lang/Throwable;

    throw v0
.end method

.method public final startNewSessionAsSender(Lcom/virgilsecurity/sdk/cards/Card;Ljava/lang/String;)Lcom/virgilsecurity/common/model/Result;
    .locals 1
    .param p1, "receiverCard"    # Lcom/virgilsecurity/sdk/cards/Card;
    .param p2, "name"    # Ljava/lang/String;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/virgilsecurity/sdk/cards/Card;",
            "Ljava/lang/String;",
            ")",
            "Lcom/virgilsecurity/common/model/Result<",
            "Lcom/virgilsecurity/ratchet/securechat/SecureSession;",
            ">;"
        }
    .end annotation

    const-string v0, "receiverCard"

    invoke-static {p1, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 223
    new-instance v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat$startNewSessionAsSender$1;

    invoke-direct {v0, p0, p1, p2}, Lcom/virgilsecurity/ratchet/securechat/SecureChat$startNewSessionAsSender$1;-><init>(Lcom/virgilsecurity/ratchet/securechat/SecureChat;Lcom/virgilsecurity/sdk/cards/Card;Ljava/lang/String;)V

    check-cast v0, Lcom/virgilsecurity/common/model/Result;

    .line 251
    return-object v0
.end method

.method public final storeSession(Lcom/virgilsecurity/ratchet/securechat/SecureSession;)V
    .locals 3
    .param p1, "session"    # Lcom/virgilsecurity/ratchet/securechat/SecureSession;

    const-string v0, "session"

    invoke-static {p1, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 168
    sget-object v0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->logger:Ljava/util/logging/Logger;

    new-instance v1, Ljava/lang/StringBuilder;

    invoke-direct {v1}, Ljava/lang/StringBuilder;-><init>()V

    const-string v2, "Storing session with "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureSession;->getParticipantIdentity()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    const-string v2, " name: "

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {p1}, Lcom/virgilsecurity/ratchet/securechat/SecureSession;->getName()Ljava/lang/String;

    move-result-object v2

    invoke-virtual {v1, v2}, Ljava/lang/StringBuilder;->append(Ljava/lang/String;)Ljava/lang/StringBuilder;

    move-result-object v1

    invoke-virtual {v1}, Ljava/lang/StringBuilder;->toString()Ljava/lang/String;

    move-result-object v1

    invoke-virtual {v0, v1}, Ljava/util/logging/Logger;->fine(Ljava/lang/String;)V

    .line 170
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/SecureChat;->sessionStorage:Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;

    invoke-interface {v0, p1}, Lcom/virgilsecurity/ratchet/sessionstorage/SessionStorage;->storeSession(Lcom/virgilsecurity/ratchet/securechat/SecureSession;)V

    .line 171
    return-void
.end method
