.class public final Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;
.super Ljava/lang/Object;
.source "KeysRotator.kt"

# interfaces
.implements Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotatorInterface;


# annotations
.annotation system Ldalvik/annotation/MemberClasses;
    value = {
        Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator$Companion;
    }
.end annotation

.annotation runtime Lkotlin/Metadata;
    bv = {
        0x1,
        0x0,
        0x3
    }
    d1 = {
        "\u0000J\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0010\u000e\n\u0000\n\u0002\u0010\u0008\n\u0002\u0008\u0004\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0002\u0008\u0002\n\u0002\u0018\u0002\n\u0002\u0018\u0002\n\u0000\n\u0002\u0018\u0002\n\u0002\u0008\u0002\u0018\u0000 \u00192\u00020\u0001:\u0001\u0019BU\u0012\u0006\u0010\u0002\u001a\u00020\u0003\u0012\u0006\u0010\u0004\u001a\u00020\u0005\u0012\u0006\u0010\u0006\u001a\u00020\u0007\u0012\u0006\u0010\u0008\u001a\u00020\t\u0012\u0006\u0010\n\u001a\u00020\t\u0012\u0006\u0010\u000b\u001a\u00020\t\u0012\u0006\u0010\u000c\u001a\u00020\t\u0012\u0006\u0010\r\u001a\u00020\u000e\u0012\u0006\u0010\u000f\u001a\u00020\u0010\u0012\u0006\u0010\u0011\u001a\u00020\u0012\u00a2\u0006\u0002\u0010\u0013J\u0016\u0010\u0014\u001a\u0008\u0012\u0004\u0012\u00020\u00160\u00152\u0006\u0010\u0017\u001a\u00020\u0018H\u0016R\u000e\u0010\u0011\u001a\u00020\u0012X\u0082\u0004\u00a2\u0006\u0002\n\u0000R\u000e\u0010\u0002\u001a\u00020\u0003X\u0082\u0004\u00a2\u0006\u0002\n\u0000R\u000e\u0010\u000c\u001a\u00020\tX\u0082\u0004\u00a2\u0006\u0002\n\u0000R\u000e\u0010\u0006\u001a\u00020\u0007X\u0082\u0004\u00a2\u0006\u0002\n\u0000R\u000e\u0010\u0004\u001a\u00020\u0005X\u0082\u0004\u00a2\u0006\u0002\n\u0000R\u000e\u0010\n\u001a\u00020\tX\u0082\u0004\u00a2\u0006\u0002\n\u0000R\u000e\u0010\r\u001a\u00020\u000eX\u0082\u0004\u00a2\u0006\u0002\n\u0000R\u000e\u0010\u000f\u001a\u00020\u0010X\u0082\u0004\u00a2\u0006\u0002\n\u0000R\u000e\u0010\u0008\u001a\u00020\tX\u0082\u0004\u00a2\u0006\u0002\n\u0000R\u000e\u0010\u000b\u001a\u00020\tX\u0082\u0004\u00a2\u0006\u0002\n\u0000\u00a8\u0006\u001a"
    }
    d2 = {
        "Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;",
        "Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotatorInterface;",
        "crypto",
        "Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;",
        "identityPrivateKey",
        "Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;",
        "identityCardId",
        "",
        "orphanedOneTimeKeyTtl",
        "",
        "longTermKeyTtl",
        "outdatedLongTermKeyTtl",
        "desiredNumberOfOneTimeKeys",
        "longTermKeysStorage",
        "Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;",
        "oneTimeKeysStorage",
        "Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;",
        "client",
        "Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;",
        "(Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;Ljava/lang/String;IIIILcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;)V",
        "rotateKeys",
        "Lcom/virgilsecurity/common/model/Result;",
        "Lcom/virgilsecurity/ratchet/securechat/keysrotation/RotationLog;",
        "token",
        "Lcom/virgilsecurity/sdk/jwt/contract/AccessToken;",
        "Companion",
        "ratchet"
    }
    k = 0x1
    mv = {
        0x1,
        0x1,
        0x10
    }
.end annotation


# static fields
.field public static final Companion:Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator$Companion;

.field private static final logger:Ljava/util/logging/Logger;


# instance fields
.field private final client:Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;

.field private final crypto:Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;

.field private final desiredNumberOfOneTimeKeys:I

.field private final identityCardId:Ljava/lang/String;

.field private final identityPrivateKey:Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;

.field private final longTermKeyTtl:I

.field private final longTermKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;

.field private final oneTimeKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;

.field private final orphanedOneTimeKeyTtl:I

.field private final outdatedLongTermKeyTtl:I


# direct methods
.method static constructor <clinit>()V
    .locals 2

    new-instance v0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator$Companion;

    const/4 v1, 0x0

    invoke-direct {v0, v1}, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator$Companion;-><init>(Lkotlin/jvm/internal/DefaultConstructorMarker;)V

    sput-object v0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->Companion:Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator$Companion;

    .line 222
    const-class v0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;

    invoke-virtual {v0}, Ljava/lang/Class;->getName()Ljava/lang/String;

    move-result-object v0

    invoke-static {v0}, Ljava/util/logging/Logger;->getLogger(Ljava/lang/String;)Ljava/util/logging/Logger;

    move-result-object v0

    sput-object v0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->logger:Ljava/util/logging/Logger;

    return-void
.end method

.method public constructor <init>(Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;Ljava/lang/String;IIIILcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;)V
    .locals 1
    .param p1, "crypto"    # Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;
    .param p2, "identityPrivateKey"    # Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;
    .param p3, "identityCardId"    # Ljava/lang/String;
    .param p4, "orphanedOneTimeKeyTtl"    # I
    .param p5, "longTermKeyTtl"    # I
    .param p6, "outdatedLongTermKeyTtl"    # I
    .param p7, "desiredNumberOfOneTimeKeys"    # I
    .param p8, "longTermKeysStorage"    # Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;
    .param p9, "oneTimeKeysStorage"    # Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;
    .param p10, "client"    # Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;

    const-string v0, "crypto"

    invoke-static {p1, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "identityPrivateKey"

    invoke-static {p2, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "identityCardId"

    invoke-static {p3, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "longTermKeysStorage"

    invoke-static {p8, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "oneTimeKeysStorage"

    invoke-static {p9, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    const-string v0, "client"

    invoke-static {p10, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 66
    invoke-direct {p0}, Ljava/lang/Object;-><init>()V

    iput-object p1, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->crypto:Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;

    iput-object p2, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->identityPrivateKey:Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;

    iput-object p3, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->identityCardId:Ljava/lang/String;

    iput p4, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->orphanedOneTimeKeyTtl:I

    iput p5, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->longTermKeyTtl:I

    iput p6, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->outdatedLongTermKeyTtl:I

    iput p7, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->desiredNumberOfOneTimeKeys:I

    iput-object p8, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->longTermKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;

    iput-object p9, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->oneTimeKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;

    iput-object p10, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->client:Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;

    return-void
.end method

.method public static final synthetic access$getClient$p(Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;)Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;
    .locals 1
    .param p0, "$this"    # Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;

    .line 66
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->client:Lcom/virgilsecurity/ratchet/client/RatchetClientInterface;

    return-object v0
.end method

.method public static final synthetic access$getCrypto$p(Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;)Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;
    .locals 1
    .param p0, "$this"    # Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;

    .line 66
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->crypto:Lcom/virgilsecurity/sdk/crypto/VirgilCrypto;

    return-object v0
.end method

.method public static final synthetic access$getDesiredNumberOfOneTimeKeys$p(Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;)I
    .locals 1
    .param p0, "$this"    # Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;

    .line 66
    iget v0, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->desiredNumberOfOneTimeKeys:I

    return v0
.end method

.method public static final synthetic access$getIdentityCardId$p(Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;)Ljava/lang/String;
    .locals 1
    .param p0, "$this"    # Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;

    .line 66
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->identityCardId:Ljava/lang/String;

    return-object v0
.end method

.method public static final synthetic access$getIdentityPrivateKey$p(Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;)Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;
    .locals 1
    .param p0, "$this"    # Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;

    .line 66
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->identityPrivateKey:Lcom/virgilsecurity/sdk/crypto/VirgilPrivateKey;

    return-object v0
.end method

.method public static final synthetic access$getLogger$cp()Ljava/util/logging/Logger;
    .locals 1

    .line 66
    sget-object v0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->logger:Ljava/util/logging/Logger;

    return-object v0
.end method

.method public static final synthetic access$getLongTermKeyTtl$p(Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;)I
    .locals 1
    .param p0, "$this"    # Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;

    .line 66
    iget v0, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->longTermKeyTtl:I

    return v0
.end method

.method public static final synthetic access$getLongTermKeysStorage$p(Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;)Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;
    .locals 1
    .param p0, "$this"    # Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;

    .line 66
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->longTermKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/LongTermKeysStorage;

    return-object v0
.end method

.method public static final synthetic access$getOneTimeKeysStorage$p(Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;)Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;
    .locals 1
    .param p0, "$this"    # Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;

    .line 66
    iget-object v0, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->oneTimeKeysStorage:Lcom/virgilsecurity/ratchet/keystorage/OneTimeKeysStorage;

    return-object v0
.end method

.method public static final synthetic access$getOrphanedOneTimeKeyTtl$p(Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;)I
    .locals 1
    .param p0, "$this"    # Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;

    .line 66
    iget v0, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->orphanedOneTimeKeyTtl:I

    return v0
.end method

.method public static final synthetic access$getOutdatedLongTermKeyTtl$p(Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;)I
    .locals 1
    .param p0, "$this"    # Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;

    .line 66
    iget v0, p0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;->outdatedLongTermKeyTtl:I

    return v0
.end method


# virtual methods
.method public declared-synchronized rotateKeys(Lcom/virgilsecurity/sdk/jwt/contract/AccessToken;)Lcom/virgilsecurity/common/model/Result;
    .locals 1
    .param p1, "token"    # Lcom/virgilsecurity/sdk/jwt/contract/AccessToken;
    .annotation system Ldalvik/annotation/Signature;
        value = {
            "(",
            "Lcom/virgilsecurity/sdk/jwt/contract/AccessToken;",
            ")",
            "Lcom/virgilsecurity/common/model/Result<",
            "Lcom/virgilsecurity/ratchet/securechat/keysrotation/RotationLog;",
            ">;"
        }
    .end annotation

    monitor-enter p0

    :try_start_0
    const-string/jumbo v0, "token"

    invoke-static {p1, v0}, Lkotlin/jvm/internal/Intrinsics;->checkParameterIsNotNull(Ljava/lang/Object;Ljava/lang/String;)V

    .line 80
    new-instance v0, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator$rotateKeys$1;

    invoke-direct {v0, p0, p1}, Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator$rotateKeys$1;-><init>(Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;Lcom/virgilsecurity/sdk/jwt/contract/AccessToken;)V

    check-cast v0, Lcom/virgilsecurity/common/model/Result;
    :try_end_0
    .catchall {:try_start_0 .. :try_end_0} :catchall_0

    .line 219
    monitor-exit p0

    return-object v0

    .line 79
    .end local p0    # "this":Lcom/virgilsecurity/ratchet/securechat/keysrotation/KeysRotator;
    .end local p1    # "token":Lcom/virgilsecurity/sdk/jwt/contract/AccessToken;
    :catchall_0
    move-exception p1

    monitor-exit p0

    throw p1
.end method
